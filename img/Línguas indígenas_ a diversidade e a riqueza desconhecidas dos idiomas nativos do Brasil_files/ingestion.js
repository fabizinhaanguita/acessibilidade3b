!function(){var e,p,o,t,u,m,v,i,n,h,f,y,w,k,a,r,b,d,I,s,q,l,R,V,j,M,W,X,_,z,P,c,T,x,U,g,S,C,E,A,H="_sotmpid",F="_sotmsid",L=!1;function Q(){return p.innerWidth||document.documentElement.clientWidth||n().clientWidth||document.documentElement.offsetWidth||n().offsetWidth}function Y(){return p.innerHeight||document.documentElement.clientHeight||n().clientHeight||document.documentElement.offsetHeight||n().offsetHeight}function B(e){return document.cookie.replace(new RegExp("(?:(?:^|.*;)\\s*"+e+"\\s*\\=\\s*([^;]*).*$)|^.*$"),"$1")||null}function G(e,t,i,n,o){e=e+"="+t+"; path=/; expires="+new Date(n+1e3*i).toUTCString()+"; max-age="+i+"; secure=true; SameSite=Strict;",o&&(e+="; domain="+o),document.cookie=e}function J(e){try{document.cookie=e+"=; path=/; expires=Thu, 01 Jan 1970 00:00:01 GMT; secure=true; SameSite=Strict;"}catch(e){t.error(e)}}function O(e){var t=M();return"0:"+(e?W.toString(36)+":"+t:t)}function K(e,t){var i,n={};switch(e.toLowerCase()){case"pageview":i="/t",n=t?{ch:t.channel,bid:t.brandId,rid:t.relationId,n:t.pageType}:{};break;case"linkclick":case"loyaltyclick":i="/c",n=t?{htcid:t.headerTestChosenId,htid:t.headerTestId,bid:t.brandId,lh:t.linkHeight,lp:t.linkPath,lps:t.linkPosition,lcp:t.linkSourcePath,lw:t.linkWidth,lx1:t.linkX1,lx2:t.linkX2,ly1:t.linkY1,ly2:t.linkY2,lxp:t.linkXPath,rid:t.relationId}:{};break;case"impressions":i="/i",n=t?{bid:t.brandId,impressions:t.impressions}:{};break;case"readingtime":i="/r",n=t?{ar:t.ar,at:t.at,bid:t.brandId,rid:t.relationId,wc:t.wc,sp:t.sp,n:t.pageType}:{};break;case"pagemapping":i="/m",n=t?{bid:t.brandId,rid:t.relationId,lps:t.linkPosition,lcp:t.linkSourcePath,lxp:t.linkXPath,uri:t.uri}:{};break;case"datalayer":i="/d",n=t?{bid:t.brandId,rid:t.relationId,au:t.author,at:t.articleType,aa:t.articleAccess,se:t.section,le:t.length,re:t.region,uri:t.uri,ti:t.title,ta:t.tags,ts:t.timestamp,vid:t.videoId,va:t.videoAuthor,vt:t.videoTitle,vpd:t.videoPublicationDate,ha:t.hash,hv:t.hasVideo,do:t.documentId,ch:t.channel,n:t.pageType}:{};break;case"videoplay":i="/v",n=t?{bid:t.brandId,vid:t.videoId,vt:t.title,rid:t.relationId,ac:"play",se:t.section,ta:t.tags,ch:t.channel,uri:t.uri,vd:t.duration,iu:t.imageUrl,va:t.authors,vpd:t.pubDate}:{}}return{endpoint:i,mapping:n}}function N(){this.queue=[]}function D(){y=O(!1),A.pageViewId=y,E=0,m("Starting page view",y)}e="undefined"!=typeof window?window:this,o=(p=e).navigator,t=p.console,u=function(){},m=function(){},v=function(){},i=function(){},p.hasOwnProperty("tentacles")&&p.tentacles.hasOwnProperty("noCookies")&&p.tentacles.noCookies&&(u("No cookies mode enabled."),L=!0),n=function(){return document.body||document.getElementsByTagName("body").item(0)},u("Initializing Tentacles ingestion module"),T=p.screen.availWidth,x=p.screen.availHeight,X=[0,10,20,5,15,16,1,11,21,6,7,17,2,12,22,23,8,18,3,13,14,24,9,19,4],_=[1,32898,32906,2147516416,32907,2147483649,2147516545,32777,138,136,2147516425,2147483658,2147516555,139,32905,32771,32770,128,32778,2147483658,2147516545,32896],z=[0,1,30,28,27,4,12,6,23,20,3,10,11,25,7,9,13,15,21,8,18,2,29,24,14],P=function(e,t){return e<<t|e>>>32-t},a=Math,r=p.crypto||p.msCrypto,b=void 0!==r&&void 0!==r.getRandomValues,d=b?function(e){e=new Uint8Array(e);return r.getRandomValues(e),e}:function(e){for(var t=new Array(e),i=0;i<e;++i)t[i]=a.floor(256*a.random());return t},I=function(e){for(var t=d(e),i="",n=0;n<t.length;++n)i+=String.fromCharCode(t[n]);return i},s=["application/pdf","video/quicktime","video/x-msvideo","audio/x-pn-realaudio-plugin","audio/mpeg3","application/googletalk","application/x-mplayer2","application/x-director","application/x-shockwave-flash","application/x-java-vm","application/x-googlegears","application/x-silverlight"],q=function(){var e=o.mimeTypes;if(u(o.mimeTypes),e)for(var t="plugins:",i=0,n=s.length;i<n;++i)t+=s[i]in e?"1":"0";else t="";return t},l=["ShockwaveFlash.ShockwaveFlash.1","AcroPDF.PDF","AgControl.AgControl","QuickTime.QuickTime"],R=function(){if("ActiveXObject"in p)for(var t="activex:",e=0,i=l.length;e<i;++e){var n=l[e];try{var o=new ActiveXObject(n);t+="1","getVersions"in o?t+="("+o.getVersions()+")":"getVariable"in o&&(t+="("+o.getVariable("$version")+")")}catch(e){t+="0"}}else t="";return t},V=function(){var e=Q(),t=Y();return[o.userAgent||"",o.platform||"",o.language||"",o.systemLanguage||"",o.userLanguage||"",T?T.toString(36):"",x?x.toString(36):"",e?e.toString(36):"",t?e.toString(36):"",q(),R()]},j=function(){var e=[(new Date).getTime().toString(36),p.location.href||"",I(32)],t=(b||e.push.apply(e,V()),e.join("")),i=[];for(r=0;r<25;r+=1)i[r]=0;if(t.length%16==15)t+="老";else{for(t+="";t.length%16!=15;)t+="\0";t+="耀"}for(var n=0;n<t.length;n+=16){for(r=0;r<16;r+=2)i[r/2]^=t.charCodeAt(n+r)+65536*t.charCodeAt(n+r+1);for(var o=0;o<22;o+=1){for(var a=[],r=0;r<5;r+=1)a[r]=i[r]^i[r+5]^i[r+10]^i[r+15]^i[r+20];var d=[];for(r=0;r<5;r+=1)d[r]=a[(r+4)%5]^P(a[(r+1)%5],1);var s=[];for(r=0;r<25;r+=1)s[X[r]]=P(i[r]^d[r%5],z[r]);for(r=0;r<5;r+=1)for(var l=0;l<25;l+=5)i[l+r]=s[l+r]^~s[l+(r+1)%5]&s[l+(r+2)%5];i[0]^=_[o]}}var c=[];for(r=0;r<8;++r){var g=i[r];c.push(255&g,g>>>8,g>>>16,g>>>24)}return c},M=function(){for(var e=j(),t="",i=0,n=e.length;i<n;++i)t+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxzy0123456789~_".charAt(63&e[i]);return b||(t+="!"),t},W=(new Date).getTime(),N.prototype.enqueue=function(e){var t=this.queue;u("Queueing item for processing; "+t.length+" currently pending.",e),t.push(e),1===t.length&&(u("No pending items; processing immediately.",e),this.processNextItem())},N.prototype.processNextItem=function(){var e=this.queue[0];switch(typeof e){case"string":this.deliverFirstPendingEvent(e);break;case"function":this.invokeFirstPendingCallback(e);break;default:i("Dropping unknown type of item in beacon queue.",e),this.onFirstPendingItemCompleted()}},N.prototype.deliverFirstPendingEvent=function(e){var t=this;u("Delivering pending event.",e);function i(){o||(o=!0,clearTimeout(a),n.apply(this,arguments))}var n,o,a,r=e.split("&").reduce(function(e,t,i,n){t=t.split("=");return e[decodeURIComponent(t[0])]=decodeURIComponent(t[1]),e},{}),d=(o=!(n=function(){t.onFirstPendingItemCompleted()}),a=setTimeout(function(){o||(o=!0,u("Timeout waiting for event callback; invoking anyway.",this,arguments),n.apply(this,arguments))},1e3),new XMLHttpRequest);d.onload=i,d.onerror=i;r="https://ingestion.smartocto.com"+K(r.t).endpoint+"?"+e;d.open("get",r,!0),d.send()},N.prototype.invokeFirstPendingCallback=function(e){e(),this.onFirstPendingItemCompleted()},N.prototype.onFirstPendingItemCompleted=function(){u("Marking pending item as complete.");var e=this.queue,e=(e.shift(),e.length);0<e?(u("Processing next item; remaining count:",e),this.processNextItem()):u("All pending items have been delivered.")},U=new N,f=L?(C=p.hasOwnProperty("tentacles")&&p.tentacles.hasOwnProperty("partyId")?p.tentacles.partyId:void 0,c=p.hasOwnProperty("tentacles")&&p.tentacles.hasOwnProperty("sessionId")?p.tentacles.sessionId:void 0,h=C||(u("No window.tentacles.partyId; generating identifier."),O(!0)),c||(u("No window.tentacles.sessionId; generating identifier."),O(!0))):(C=B(H),c=B(F),h=(w=!C)?(u("No partyId; generating identifier."),O(!0)):C,(k=!c)?(u("No sessionId; generating identifier."),O(!0)):c),m("Tentacles ingestion party/session identifiers",h,f),E=0,A={partyId:h,sessionId:f,pageViewId:y,isNewPartyId:w,isFirstInSession:k,active:!1,signal:function(e,t){var i,n,o;if(y||D(),e){i=E++,i=y+i.toString(16),void 0===t?m("Signalling event: "+e,i):m("Signalling event with params: "+e,i,t);var a,r,d=document.referrer,s=(new Date).getTime(),l={p:h,s:f,v:y,e:i,c:s,f:k?"t":"f",l:p.location.href,r:d||void 0,i:T,j:x,k:p.devicePixelRatio,w:Q(),h:Y(),t:e},d=("impressions"!==e&&"readingtime"!==e&&"pagemapping"!==e&&"datalayer"!==e&&"videoplay"!==e||(delete l.v,delete l.f,delete l.r,delete l.i,delete l.j,delete l.k,delete l.w,delete l.h),K(e,t).mapping),c=(Object.assign(l,d),""),g={};for(a in l)l.hasOwnProperty(a)&&void 0!==(r=l[a])&&(n=a,r=r,o=void 0,0<c.length&&(c+="&"),void 0===(o=g[n])&&(g[n]=o=[]),o.push(r),c+=n+"="+encodeURIComponent(r));k=w=!1,L?(u("No cookies mode; not setting cookies, we will delete them on page unload."),J(H),J(F)):(f&&(u("Setting session cookie.",f),G(F,f,1800,s,"")),h&&(u("Setting party cookie.",h),G(H,h,15552e3,s,""))),U.enqueue(c)}else v("Ignoring event with no type."),i=null;return i},apiToken:p.hasOwnProperty("tentacles")&&p.tentacles.hasOwnProperty("apiToken")?p.tentacles.apiToken:null},"object"==typeof p.ingestion&&p.ingestion.hasOwnProperty("partyId")?v("Ingestion module already initialized; existing module left intact."):(("function"!=typeof p.define||!p.define.amd)&&void 0!==p.module&&p.module.exports?p.module.exports=A:p.ingestion=A,u("Module initialized.",A),void 0!==document.hidden?(g="hidden",S="visibilitychange"):void 0!==document.mozHidden?(g="mozHidden",S="mozvisibilitychange"):void 0!==document.msHidden?(g="msHidden",S="msvisibilitychange"):void 0!==document.webkitHidden?(g="webkitHidden",S="webkitvisibilitychange"):v("Could not detect property for document visibility."),p.document[g]?p.document.addEventListener&&p.document.removeEventListener?(u("Page currently hidden; deferring start of page view."),p.document.addEventListener(S,function e(){null===y&&!1===p.document[g]&&(u("Page became visible; starting deferred page view."),D()),null!==y&&p.document.removeEventListener(S,e)})):(v("Page currently hidden, but don't know how to defer start of page view; starting page view immediately."),D()):(u("Page already visible; starting page view immediately."),D()),"onpageshow"in p&&"onpagehide"in p&&p.addEventListener&&p.removeEventListener?(u("Detected Page Transition Event API; will trigger additional page-views during navigation."),p.addEventListener("pagehide",function e(){p.removeEventListener("pagehide",e),p.addEventListener("pageshow",function(){u("Returning to page that is still loaded; starting a new page-view."),D()})})):(C=p.history)&&(C.navigationMode,1)&&(m("Changing navigation mode from "+C.navigationMode+" to 'compatible'."),C.navigationMode="compatible"))}("undefined"==typeof t&&(t={}));